FROM openjdk:17-alpine
COPY ./build/libs/api-server.jar /minionz/backend.jar

# ARG 선언
ARG AWS_ACCESSKEY
ARG AWS_REGION
ARG AWS_SECRETKEY
ARG DB_PASSWORD
ARG DB_URL
ARG DB_USERNAME
ARG GITHUB_CLIENT_ID
ARG GITHUB_CLIENT_SECRET
ARG GOOGLE_CLIENT_ID
ARG GOOGLE_CLIENT_SECRET
ARG JWT_SECRET
ARG KAFKA_SERVER
ARG KAKAO_CLIENT_ID
ARG KAKAO_CLIENT_SECRET
ARG MAIL_HOST
ARG MAIL_PASSWORD
ARG MAIL_PORT
ARG MAIL_USERNAME
ARG NAVER_CLIENT_ID
ARG NAVER_CLIENT_SECRET
ARG S3_BUCKET
ARG DOMAIN_ADDRESS
ARG GEMINI_API_KEY
ARG CHATBOT_WEBHOOK_NOTE_URL
ARG CHATBOT_WEBHOOK_MEETING_URL
ARG CHATBOT_WEBHOOK_ETC_URL
ARG REDIS_HOST
ARG REDIS_PORT


# ENV 설정
ENV AWS_ACCESSKEY=${AWS_ACCESSKEY}
ENV AWS_REGION=${AWS_REGION}
ENV AWS_SECRETKEY=${AWS_SECRETKEY}
ENV DB_PASSWORD=${DB_PASSWORD}
ENV DB_URL=${DB_URL}
ENV DB_USERNAME=${DB_USERNAME}
ENV GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
ENV GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
ENV GOOGLE_CLIENT_ID=${GOOGLE_CLIENT_ID}
ENV GOOGLE_CLIENT_SECRET=${GOOGLE_CLIENT_SECRET}
ENV JWT_SECRET=${JWT_SECRET}
ENV KAFKA_SERVER=${KAFKA_SERVER}
ENV KAKAO_CLIENT_ID=${KAKAO_CLIENT_ID}
ENV KAKAO_CLIENT_SECRET=${KAKAO_CLIENT_SECRET}
ENV MAIL_HOST=${MAIL_HOST}
ENV MAIL_PASSWORD=${MAIL_PASSWORD}
ENV MAIL_PORT=${MAIL_PORT}
ENV MAIL_USERNAME=${MAIL_USERNAME}
ENV NAVER_CLIENT_ID=${NAVER_CLIENT_ID}
ENV NAVER_CLIENT_SECRET=${NAVER_CLIENT_SECRET}
ENV S3_BUCKET=${S3_BUCKET}
ENV DOMAIN_ADDRESS=${DOMAIN_ADDRESS}
ENV GEMINI_API_KEY=${GEMINI_API_KEY}
ENV CHATBOT_WEBHOOK_NOTE_URL=${CHATBOT_WEBHOOK_NOTE_URL}
ENV CHATBOT_WEBHOOK_MEETING_URL=${CHATBOT_WEBHOOK_MEETING_URL}
ENV CHATBOT_WEBHOOK_ETC_URL=${CHATBOT_WEBHOOK_ETC_URL}
ENV REDIS_HOST=${REDIS_HOST}
ENV REDIS_PORT=${REDIS_PORT}

CMD ["java", "-jar", "/minionz/backend.jar"]
